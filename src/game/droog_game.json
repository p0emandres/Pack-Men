{
  "address": "2xzwRYwn1gdVBd5FBrvWV5To6qKR9pn9UfiJnZz8GwC2",
  "metadata": {
    "name": "droog_game",
    "version": "0.1.0",
    "spec": "0.1.0",
    "description": "Competitive 1v1 grow/harvest game on Solana"
  },
  "instructions": [
    {
      "name": "cancel_match",
      "docs": [
        "Cancel a pending match and refund Player A",
        "",
        "Security requirement (non-optional):",
        "- Only callable if status == Pending",
        "- Only callable after CANCEL_TIMEOUT_SECONDS",
        "- Player A gets 100% refund (no burn in Pending state)"
      ],
      "discriminator": [
        142,
        136,
        247,
        45,
        92,
        112,
        180,
        83
      ],
      "accounts": [
        {
          "name": "stake_state",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  115,
                  116,
                  97,
                  107,
                  101
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "mint",
          "docs": [
            "$PACKS token mint"
          ]
        },
        {
          "name": "player_a_token_account",
          "docs": [
            "Player A's $PACKS token account (receives refund)"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "account",
                "path": "player_a"
              },
              {
                "kind": "const",
                "value": [
                  6,
                  221,
                  246,
                  225,
                  215,
                  101,
                  161,
                  147,
                  217,
                  203,
                  225,
                  70,
                  206,
                  235,
                  121,
                  172,
                  28,
                  180,
                  133,
                  237,
                  95,
                  91,
                  55,
                  145,
                  58,
                  140,
                  245,
                  133,
                  126,
                  255,
                  0,
                  169
                ]
              },
              {
                "kind": "account",
                "path": "mint"
              }
            ],
            "program": {
              "kind": "const",
              "value": [
                140,
                151,
                37,
                143,
                78,
                36,
                137,
                241,
                187,
                61,
                16,
                41,
                20,
                142,
                13,
                131,
                11,
                90,
                19,
                153,
                218,
                255,
                16,
                132,
                4,
                142,
                123,
                216,
                219,
                233,
                248,
                89
              ]
            }
          }
        },
        {
          "name": "escrow_token_account",
          "docs": [
            "Escrow token account"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "escrow_authority",
          "docs": [
            "Escrow authority PDA (signs for refund transfer)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119,
                  95,
                  97,
                  117,
                  116,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "player_a",
          "docs": [
            "Only Player A can cancel"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "token_program"
        },
        {
          "name": "associated_token_program",
          "address": "ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": []
    },
    {
      "name": "finalize_match",
      "docs": [
        "Finalize a match and distribute stake to winner",
        "",
        "Settlement code - treat as sacred:",
        "- Requires status == Active",
        "- Winner determined by sales count (on-chain)",
        "- Entire escrow balance goes to winner"
      ],
      "discriminator": [
        6,
        103,
        47,
        7,
        66,
        1,
        85,
        207
      ],
      "accounts": [
        {
          "name": "match_state",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_state.match_id_hash",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_a",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_b",
                "account": "MatchState"
              }
            ]
          }
        },
        {
          "name": "stake_state",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  115,
                  116,
                  97,
                  107,
                  101
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "mint",
          "docs": [
            "$PACKS token mint"
          ]
        },
        {
          "name": "escrow_token_account",
          "docs": [
            "Escrow token account"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "escrow_authority",
          "docs": [
            "Escrow authority PDA (signs for payout transfer)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119,
                  95,
                  97,
                  117,
                  116,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "winner_token_account",
          "docs": [
            "Winner's token account (receives payout)",
            "Constraint: must belong to either player_a or player_b"
          ],
          "writable": true
        },
        {
          "name": "player",
          "signer": true
        },
        {
          "name": "token_program"
        },
        {
          "name": "associated_token_program",
          "address": "ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": []
    },
    {
      "name": "harvest",
      "docs": [
        "Legacy harvest instruction (kept for backwards compatibility)",
        "Note: New code should use harvest_strain instead"
      ],
      "discriminator": [
        228,
        241,
        31,
        182,
        53,
        169,
        59,
        199
      ],
      "accounts": [
        {
          "name": "match_state",
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_state.match_id_hash",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_a",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_b",
                "account": "MatchState"
              }
            ]
          }
        },
        {
          "name": "player",
          "signer": true
        }
      ],
      "args": [
        {
          "name": "strain_id",
          "type": "u8"
        },
        {
          "name": "planted_at",
          "type": "i64"
        },
        {
          "name": "last_harvested_at",
          "type": {
            "option": "i64"
          }
        }
      ]
    },
    {
      "name": "harvest_strain",
      "docs": [
        "Harvest a ready plant from a grow slot",
        "Increments player inventory"
      ],
      "discriminator": [
        83,
        255,
        209,
        133,
        245,
        167,
        32,
        111
      ],
      "accounts": [
        {
          "name": "grow_state",
          "docs": [
            "The grow state PDA",
            "Boxed to avoid stack overflow (account is ~359 bytes)"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  103,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "account",
                "path": "grow_state.match_id",
                "account": "MatchGrowState"
              }
            ]
          }
        },
        {
          "name": "match_state",
          "docs": [
            "The corresponding match state (for timing validation)",
            "Boxed to avoid stack overflow (account is large with 23 customers)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "grow_state.match_id_hash",
                "account": "MatchGrowState"
              },
              {
                "kind": "account",
                "path": "grow_state.player_a",
                "account": "MatchGrowState"
              },
              {
                "kind": "account",
                "path": "grow_state.player_b",
                "account": "MatchGrowState"
              }
            ]
          }
        },
        {
          "name": "player",
          "docs": [
            "The player harvesting the plant"
          ],
          "signer": true
        }
      ],
      "args": [
        {
          "name": "slot_index",
          "type": "u8"
        }
      ]
    },
    {
      "name": "init_delivery_state",
      "docs": [
        "Initialize the delivery state PDA for a match",
        "Should be called after init_match, before gameplay begins",
        "",
        "Authority: Solana ONLY",
        "- Delivery spots are selected deterministically",
        "- Client cannot influence initial selection"
      ],
      "discriminator": [
        28,
        193,
        130,
        189,
        74,
        93,
        224,
        44
      ],
      "accounts": [
        {
          "name": "delivery_state",
          "docs": [
            "The delivery state PDA to initialize"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  100,
                  101,
                  108,
                  105,
                  118,
                  101,
                  114,
                  121
                ]
              },
              {
                "kind": "arg",
                "path": "match_id"
              }
            ]
          }
        },
        {
          "name": "match_state",
          "docs": [
            "The corresponding match state (must exist)",
            "Boxed to avoid stack overflow (account is large with 23 customers)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "arg",
                "path": "match_id_hash"
              },
              {
                "kind": "account",
                "path": "match_state.player_a",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_b",
                "account": "MatchState"
              }
            ]
          }
        },
        {
          "name": "payer",
          "docs": [
            "Payer for account creation (should be one of the players)"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "system_program",
          "docs": [
            "System program for account creation"
          ],
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "match_id_hash",
          "type": {
            "array": [
              "u8",
              32
            ]
          }
        },
        {
          "name": "match_id",
          "type": "u64"
        }
      ]
    },
    {
      "name": "init_grow_state",
      "docs": [
        "Initialize the grow state PDA for a match",
        "Should be called after init_match"
      ],
      "discriminator": [
        127,
        199,
        146,
        67,
        238,
        161,
        246,
        197
      ],
      "accounts": [
        {
          "name": "grow_state",
          "docs": [
            "The grow state PDA to initialize",
            "Boxed to avoid stack overflow (account is ~359 bytes)"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  103,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "arg",
                "path": "match_id"
              }
            ]
          }
        },
        {
          "name": "match_state",
          "docs": [
            "The corresponding match state (must exist)",
            "Boxed to avoid stack overflow (account is large with 23 customers)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "arg",
                "path": "match_id_hash"
              },
              {
                "kind": "account",
                "path": "match_state.player_a",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_b",
                "account": "MatchState"
              }
            ]
          }
        },
        {
          "name": "payer",
          "docs": [
            "Payer for account creation (should be one of the players)"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "system_program",
          "docs": [
            "System program for account creation"
          ],
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "match_id_hash",
          "type": {
            "array": [
              "u8",
              32
            ]
          }
        },
        {
          "name": "match_id",
          "type": "u64"
        }
      ]
    },
    {
      "name": "init_match",
      "docs": [
        "Initialize a match with Player A's stake",
        "",
        "Option C Semantics:",
        "- Player A escrows 100% of stake (NO BURN)",
        "- Match status = Pending",
        "- Player A can cancel if Player B never joins"
      ],
      "discriminator": [
        168,
        73,
        110,
        30,
        58,
        141,
        39,
        145
      ],
      "accounts": [
        {
          "name": "match_state",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "arg",
                "path": "match_id_hash"
              },
              {
                "kind": "account",
                "path": "player_a"
              },
              {
                "kind": "account",
                "path": "player_b"
              }
            ]
          }
        },
        {
          "name": "stake_state",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  115,
                  116,
                  97,
                  107,
                  101
                ]
              },
              {
                "kind": "arg",
                "path": "match_id_hash"
              }
            ]
          }
        },
        {
          "name": "mint",
          "docs": [
            "$PACKS token mint"
          ],
          "writable": true
        },
        {
          "name": "player_a_token_account",
          "docs": [
            "Player A's $PACKS token account"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "account",
                "path": "player_a"
              },
              {
                "kind": "const",
                "value": [
                  6,
                  221,
                  246,
                  225,
                  215,
                  101,
                  161,
                  147,
                  217,
                  203,
                  225,
                  70,
                  206,
                  235,
                  121,
                  172,
                  28,
                  180,
                  133,
                  237,
                  95,
                  91,
                  55,
                  145,
                  58,
                  140,
                  245,
                  133,
                  126,
                  255,
                  0,
                  169
                ]
              },
              {
                "kind": "account",
                "path": "mint"
              }
            ],
            "program": {
              "kind": "const",
              "value": [
                140,
                151,
                37,
                143,
                78,
                36,
                137,
                241,
                187,
                61,
                16,
                41,
                20,
                142,
                13,
                131,
                11,
                90,
                19,
                153,
                218,
                255,
                16,
                132,
                4,
                142,
                123,
                216,
                219,
                233,
                248,
                89
              ]
            }
          }
        },
        {
          "name": "escrow_token_account",
          "docs": [
            "Escrow token account (PDA-controlled)",
            "Seeds: [\"escrow\", match_id_hash]"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "arg",
                "path": "match_id_hash"
              }
            ]
          }
        },
        {
          "name": "escrow_authority",
          "docs": [
            "Escrow authority PDA (signs for escrow transfers)",
            "Seeds: [\"escrow_auth\", match_id_hash]"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119,
                  95,
                  97,
                  117,
                  116,
                  104
                ]
              },
              {
                "kind": "arg",
                "path": "match_id_hash"
              }
            ]
          }
        },
        {
          "name": "player_a",
          "writable": true,
          "signer": true
        },
        {
          "name": "player_b",
          "docs": [
            "Player B's public key (used for PDA derivation)"
          ]
        },
        {
          "name": "token_program"
        },
        {
          "name": "associated_token_program",
          "address": "ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "match_id_hash",
          "type": {
            "array": [
              "u8",
              32
            ]
          }
        },
        {
          "name": "match_id",
          "type": {
            "option": "u64"
          }
        },
        {
          "name": "start_ts",
          "type": "i64"
        }
      ]
    },
    {
      "name": "join_match_with_stake",
      "docs": [
        "Player B joins the match and stakes their tokens",
        "",
        "Option C Critical:",
        "- Player B escrows 100% of stake",
        "- Burn occurs ONLY here (10% of total)",
        "- Match becomes Active ATOMICALLY with burn"
      ],
      "discriminator": [
        114,
        86,
        145,
        67,
        121,
        135,
        167,
        239
      ],
      "accounts": [
        {
          "name": "stake_state",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  115,
                  116,
                  97,
                  107,
                  101
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "mint",
          "docs": [
            "$PACKS token mint"
          ],
          "writable": true
        },
        {
          "name": "player_b_token_account",
          "docs": [
            "Player B's $PACKS token account"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "account",
                "path": "player_b"
              },
              {
                "kind": "const",
                "value": [
                  6,
                  221,
                  246,
                  225,
                  215,
                  101,
                  161,
                  147,
                  217,
                  203,
                  225,
                  70,
                  206,
                  235,
                  121,
                  172,
                  28,
                  180,
                  133,
                  237,
                  95,
                  91,
                  55,
                  145,
                  58,
                  140,
                  245,
                  133,
                  126,
                  255,
                  0,
                  169
                ]
              },
              {
                "kind": "account",
                "path": "mint"
              }
            ],
            "program": {
              "kind": "const",
              "value": [
                140,
                151,
                37,
                143,
                78,
                36,
                137,
                241,
                187,
                61,
                16,
                41,
                20,
                142,
                13,
                131,
                11,
                90,
                19,
                153,
                218,
                255,
                16,
                132,
                4,
                142,
                123,
                216,
                219,
                233,
                248,
                89
              ]
            }
          }
        },
        {
          "name": "escrow_token_account",
          "docs": [
            "Escrow token account (already initialized by init_match)"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "escrow_authority",
          "docs": [
            "Escrow authority PDA (signs for escrow burns)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  101,
                  115,
                  99,
                  114,
                  111,
                  119,
                  95,
                  97,
                  117,
                  116,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "stake_state.match_id_hash",
                "account": "MatchStakeState"
              }
            ]
          }
        },
        {
          "name": "player_b",
          "writable": true,
          "signer": true
        },
        {
          "name": "token_program"
        },
        {
          "name": "associated_token_program",
          "address": "ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": []
    },
    {
      "name": "plant_strain",
      "docs": [
        "Plant a strain in a grow slot",
        "Validates endgame lock, slot availability, and timing"
      ],
      "discriminator": [
        226,
        16,
        67,
        142,
        237,
        127,
        31,
        149
      ],
      "accounts": [
        {
          "name": "grow_state",
          "docs": [
            "The grow state PDA",
            "Boxed to avoid stack overflow (account is ~359 bytes)"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  103,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "account",
                "path": "grow_state.match_id",
                "account": "MatchGrowState"
              }
            ]
          }
        },
        {
          "name": "match_state",
          "docs": [
            "The corresponding match state (for timing validation)",
            "Boxed to avoid stack overflow (account is large with 23 customers)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "grow_state.match_id_hash",
                "account": "MatchGrowState"
              },
              {
                "kind": "account",
                "path": "grow_state.player_a",
                "account": "MatchGrowState"
              },
              {
                "kind": "account",
                "path": "grow_state.player_b",
                "account": "MatchGrowState"
              }
            ]
          }
        },
        {
          "name": "player",
          "docs": [
            "The player planting the strain"
          ],
          "signer": true
        }
      ],
      "args": [
        {
          "name": "slot_index",
          "type": "u8"
        },
        {
          "name": "strain_level",
          "type": "u8"
        }
      ]
    },
    {
      "name": "refresh_delivery_slots",
      "docs": [
        "Refresh delivery slots after 60-second rotation interval",
        "",
        "Permissionless: Anyone can call this, but it only succeeds if:",
        "- 60 seconds have passed since last refresh",
        "- Match is still active",
        "",
        "Authority: Solana ONLY",
        "- Selection is purely deterministic from match_id + timestamp bucket",
        "- All clients can independently verify expected spots"
      ],
      "discriminator": [
        141,
        174,
        244,
        246,
        233,
        168,
        175,
        107
      ],
      "accounts": [
        {
          "name": "delivery_state",
          "docs": [
            "The delivery state PDA to update"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  100,
                  101,
                  108,
                  105,
                  118,
                  101,
                  114,
                  121
                ]
              },
              {
                "kind": "account",
                "path": "delivery_state.match_id",
                "account": "MatchDeliveryState"
              }
            ]
          }
        },
        {
          "name": "match_state",
          "docs": [
            "The corresponding match state (for validation)",
            "Boxed to avoid stack overflow (account is large with 23 customers)"
          ],
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_state.match_id_hash",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_a",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_b",
                "account": "MatchState"
              }
            ]
          }
        }
      ],
      "args": []
    },
    {
      "name": "sell_to_customer",
      "docs": [
        "Sell a strain to a customer",
        "Burns from inventory and applies variant reputation modifier"
      ],
      "discriminator": [
        178,
        207,
        200,
        153,
        118,
        221,
        9,
        36
      ],
      "accounts": [
        {
          "name": "match_state",
          "docs": [
            "Boxed to avoid stack overflow (account is large with 23 customers)"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_state.match_id_hash",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_a",
                "account": "MatchState"
              },
              {
                "kind": "account",
                "path": "match_state.player_b",
                "account": "MatchState"
              }
            ]
          }
        },
        {
          "name": "grow_state",
          "docs": [
            "The grow state PDA (for inventory management)",
            "Boxed to avoid stack overflow (account is ~359 bytes)"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  103,
                  114,
                  111,
                  119
                ]
              },
              {
                "kind": "account",
                "path": "grow_state.match_id",
                "account": "MatchGrowState"
              }
            ]
          }
        },
        {
          "name": "delivery_state",
          "docs": [
            "The delivery state PDA (for availability validation and removal after sale)",
            "AUTHORITY: Solana determines which customers are available for delivery.",
            "Client CANNOT influence this - only render indicators based on this state.",
            "NOTE: Mutable because we remove the customer from availability after sale.",
            "Each customer can only be delivered to ONCE per rotation cycle."
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  100,
                  101,
                  108,
                  105,
                  118,
                  101,
                  114,
                  121
                ]
              },
              {
                "kind": "account",
                "path": "match_state.match_id",
                "account": "MatchState"
              }
            ]
          }
        },
        {
          "name": "player",
          "signer": true
        }
      ],
      "args": [
        {
          "name": "customer_index",
          "type": "u8"
        },
        {
          "name": "strain_level",
          "type": "u8"
        }
      ]
    }
  ],
  "accounts": [
    {
      "name": "MatchDeliveryState",
      "discriminator": [
        75,
        82,
        86,
        228,
        100,
        194,
        153,
        125
      ]
    },
    {
      "name": "MatchGrowState",
      "discriminator": [
        189,
        27,
        230,
        206,
        182,
        124,
        93,
        232
      ]
    },
    {
      "name": "MatchStakeState",
      "discriminator": [
        251,
        144,
        20,
        250,
        46,
        153,
        75,
        114
      ]
    },
    {
      "name": "MatchState",
      "discriminator": [
        250,
        209,
        137,
        70,
        235,
        96,
        121,
        216
      ]
    }
  ],
  "events": [
    {
      "name": "DeliveryRotationEvent",
      "discriminator": [
        223,
        141,
        100,
        86,
        125,
        87,
        100,
        200
      ]
    },
    {
      "name": "DeliveryStateInitializedEvent",
      "discriminator": [
        149,
        234,
        153,
        201,
        214,
        171,
        108,
        187
      ]
    },
    {
      "name": "GrowStateInitializedEvent",
      "discriminator": [
        222,
        118,
        104,
        137,
        205,
        71,
        173,
        202
      ]
    },
    {
      "name": "HarvestEvent",
      "discriminator": [
        33,
        112,
        85,
        175,
        175,
        39,
        21,
        88
      ]
    },
    {
      "name": "HarvestStrainEvent",
      "discriminator": [
        25,
        222,
        65,
        42,
        181,
        109,
        102,
        166
      ]
    },
    {
      "name": "MatchActivatedEvent",
      "discriminator": [
        252,
        4,
        191,
        226,
        52,
        255,
        204,
        126
      ]
    },
    {
      "name": "MatchCancelledEvent",
      "discriminator": [
        229,
        189,
        48,
        183,
        219,
        47,
        20,
        37
      ]
    },
    {
      "name": "MatchFinalizedEvent",
      "discriminator": [
        253,
        68,
        199,
        47,
        123,
        171,
        248,
        221
      ]
    },
    {
      "name": "MatchStakeInitializedEvent",
      "discriminator": [
        201,
        152,
        1,
        192,
        27,
        221,
        0,
        224
      ]
    },
    {
      "name": "PlantStrainEvent",
      "discriminator": [
        232,
        231,
        105,
        239,
        53,
        106,
        53,
        181
      ]
    },
    {
      "name": "SaleEvent",
      "discriminator": [
        157,
        252,
        47,
        101,
        28,
        49,
        225,
        223
      ]
    },
    {
      "name": "StakePayoutEvent",
      "discriminator": [
        150,
        45,
        231,
        104,
        225,
        253,
        113,
        58
      ]
    }
  ],
  "errors": [
    {
      "code": 6000,
      "name": "MatchNotStarted",
      "msg": "Match has not started yet"
    },
    {
      "code": 6001,
      "name": "MatchEnded",
      "msg": "Match has already ended"
    },
    {
      "code": 6002,
      "name": "GrowthTimeNotElapsed",
      "msg": "Plant growth time has not elapsed"
    },
    {
      "code": 6003,
      "name": "RegrowthLockoutActive",
      "msg": "Regrowth lockout period has not passed"
    },
    {
      "code": 6004,
      "name": "StrainNotActive",
      "msg": "Strain is not currently active"
    },
    {
      "code": 6005,
      "name": "CustomerOnCooldown",
      "msg": "Customer cooldown has not passed"
    },
    {
      "code": 6006,
      "name": "InvalidStrainLevel",
      "msg": "Strain level does not match customer preferences"
    },
    {
      "code": 6007,
      "name": "InvalidCustomerIndex",
      "msg": "Invalid customer index"
    },
    {
      "code": 6008,
      "name": "InvalidPlayer",
      "msg": "Player is not part of this match"
    },
    {
      "code": 6009,
      "name": "CustomerNotAvailable",
      "msg": "Customer is not available"
    },
    {
      "code": 6010,
      "name": "InvalidLayer",
      "msg": "Invalid layer assignment"
    },
    {
      "code": 6011,
      "name": "MatchAlreadyFinalized",
      "msg": "Match has already been finalized"
    },
    {
      "code": 6012,
      "name": "MatchFinalizationTooEarly",
      "msg": "Match cannot be finalized before end time"
    },
    {
      "code": 6013,
      "name": "UnauthorizedFinalization",
      "msg": "Only match participants can finalize the match"
    },
    {
      "code": 6014,
      "name": "MatchIdMismatch",
      "msg": "Match ID mismatch between accounts"
    },
    {
      "code": 6015,
      "name": "EndgamePlantingLocked",
      "msg": "Planting is locked during the final minute of the match"
    },
    {
      "code": 6016,
      "name": "InvalidSlotIndex",
      "msg": "Invalid grow slot index (must be 0-5)"
    },
    {
      "code": 6017,
      "name": "SlotOccupied",
      "msg": "Grow slot is already occupied (plant_state is not Empty)"
    },
    {
      "code": 6018,
      "name": "SlotEmpty",
      "msg": "Grow slot is empty"
    },
    {
      "code": 6019,
      "name": "PlantWontBeReady",
      "msg": "Plant will not be ready before match ends"
    },
    {
      "code": 6020,
      "name": "InsufficientInventory",
      "msg": "Insufficient inventory to complete this sale"
    },
    {
      "code": 6021,
      "name": "InventoryFull",
      "msg": "Inventory is at capacity (6 items max)"
    },
    {
      "code": 6022,
      "name": "CustomerNotAvailableForDelivery",
      "msg": "Customer is not available for delivery in the current rotation"
    },
    {
      "code": 6023,
      "name": "DeliveryRotationTooSoon",
      "msg": "Delivery slots have not rotated yet (60s minimum between refreshes)"
    },
    {
      "code": 6024,
      "name": "DeliveryStateNotInitialized",
      "msg": "Delivery state has not been initialized for this match"
    },
    {
      "code": 6025,
      "name": "InvalidPlayerOrder",
      "msg": "Player A must have a lower pubkey than Player B for deterministic PDA derivation"
    },
    {
      "code": 6026,
      "name": "InsufficientStakeBalance",
      "msg": "Insufficient token balance for staking"
    },
    {
      "code": 6027,
      "name": "MatchNotPending",
      "msg": "Match is not in Pending status"
    },
    {
      "code": 6028,
      "name": "MatchNotActive",
      "msg": "Match is not in Active status"
    },
    {
      "code": 6029,
      "name": "CancelTooEarly",
      "msg": "Cancel timeout has not elapsed (must wait 5 minutes)"
    },
    {
      "code": 6030,
      "name": "PlayerBAlreadyJoined",
      "msg": "Cannot cancel - Player B has already joined"
    },
    {
      "code": 6031,
      "name": "StakeExceedsMaximum",
      "msg": "Stake amount exceeds maximum (1 token)"
    },
    {
      "code": 6032,
      "name": "AlreadyStaked",
      "msg": "Player has already staked"
    },
    {
      "code": 6033,
      "name": "CalculationOverflow",
      "msg": "Arithmetic overflow in calculation"
    }
  ],
  "types": [
    {
      "name": "CustomerState",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "layer",
            "type": "u8"
          },
          {
            "name": "last_served_ts",
            "type": "i64"
          },
          {
            "name": "total_serves",
            "type": "u32"
          },
          {
            "name": "last_served_by",
            "type": {
              "option": "pubkey"
            }
          }
        ]
      }
    },
    {
      "name": "DeliveryRotationEvent",
      "docs": [
        "Event emitted when delivery slots rotate",
        "",
        "This event allows:",
        "- Clients to sync their visual indicators",
        "- Post-match audit of rotation history",
        "- Analytics on player navigation patterns"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "docs": [
              "Unique match identifier"
            ],
            "type": "u64"
          },
          {
            "name": "previous_spots",
            "docs": [
              "Previous delivery spots (for analytics)"
            ],
            "type": {
              "array": [
                "u8",
                5
              ]
            }
          },
          {
            "name": "previous_count",
            "docs": [
              "Previous active count"
            ],
            "type": "u8"
          },
          {
            "name": "new_spots",
            "docs": [
              "New delivery spots"
            ],
            "type": {
              "array": [
                "u8",
                5
              ]
            }
          },
          {
            "name": "new_count",
            "docs": [
              "New active count"
            ],
            "type": "u8"
          },
          {
            "name": "rotation_bucket",
            "docs": [
              "Current rotation bucket (ts / 60)"
            ],
            "type": "u64"
          },
          {
            "name": "timestamp",
            "docs": [
              "Rotation timestamp"
            ],
            "type": "i64"
          },
          {
            "name": "remaining_match_time",
            "docs": [
              "Remaining time in match (for pacing analytics)"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "DeliveryStateInitializedEvent",
      "docs": [
        "Event emitted when delivery state is initialized"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "docs": [
              "Unique match identifier"
            ],
            "type": "u64"
          },
          {
            "name": "initial_spots",
            "docs": [
              "Initial delivery spots selected"
            ],
            "type": {
              "array": [
                "u8",
                5
              ]
            }
          },
          {
            "name": "active_count",
            "docs": [
              "Number of active spots"
            ],
            "type": "u8"
          },
          {
            "name": "rotation_bucket",
            "docs": [
              "Rotation bucket number for client sync"
            ],
            "type": "u64"
          },
          {
            "name": "timestamp",
            "docs": [
              "Initialization timestamp"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "GrowSlot",
      "docs": [
        "Individual grow slot state",
        "Slots represent land - they persist for the entire match",
        "Plants are ephemeral - destroyed on harvest, slot immediately freed"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "plant_state",
            "docs": [
              "Current plant state (Empty, Growing, or Ready)"
            ],
            "type": {
              "defined": {
                "name": "PlantState"
              }
            }
          },
          {
            "name": "strain_level",
            "docs": [
              "Strain level (1, 2, or 3) - stored for variant lookup after harvest",
              "Only valid when plant_state != Empty (but kept for variant tracking)"
            ],
            "type": "u8"
          },
          {
            "name": "variant_id",
            "docs": [
              "Deterministic variant ID (0, 1, or 2) - stored for variant lookup after harvest",
              "Only valid when plant_state != Empty (but kept for variant tracking)"
            ],
            "type": "u8"
          },
          {
            "name": "last_harvested_ts",
            "docs": [
              "Timestamp of last harvest (only valid when plant_state == Empty)",
              "Used to determine most recently harvested variant for sales"
            ],
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "GrowStateInitializedEvent",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "player_a",
            "type": "pubkey"
          },
          {
            "name": "player_b",
            "type": "pubkey"
          }
        ]
      }
    },
    {
      "name": "HarvestEvent",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "player",
            "type": "pubkey"
          },
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "strain_id",
            "type": "u8"
          },
          {
            "name": "harvested_at",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "HarvestStrainEvent",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "player",
            "type": "pubkey"
          },
          {
            "name": "slot_index",
            "type": "u8"
          },
          {
            "name": "strain_level",
            "type": "u8"
          },
          {
            "name": "variant_id",
            "type": "u8"
          },
          {
            "name": "harvested_ts",
            "type": "i64"
          },
          {
            "name": "new_inventory_count",
            "type": "u8"
          },
          {
            "name": "total_inventory",
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "Inventory",
      "docs": [
        "Player inventory - tracks harvested strains by level",
        "Fixed capacity system: hard limit of 6 total items prevents hoarding"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "level1",
            "docs": [
              "Count of Level 1 strains in inventory"
            ],
            "type": "u8"
          },
          {
            "name": "level2",
            "docs": [
              "Count of Level 2 strains in inventory"
            ],
            "type": "u8"
          },
          {
            "name": "level3",
            "docs": [
              "Count of Level 3 strains in inventory"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "MatchActivatedEvent",
      "docs": [
        "Event emitted when Player B joins and match activates"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "player_a",
            "type": "pubkey"
          },
          {
            "name": "player_b",
            "type": "pubkey"
          },
          {
            "name": "total_escrowed",
            "type": "u64"
          },
          {
            "name": "amount_burned",
            "type": "u64"
          },
          {
            "name": "final_pot",
            "type": "u64"
          },
          {
            "name": "timestamp",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "MatchCancelledEvent",
      "docs": [
        "Event emitted when match is cancelled and Player A is refunded"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "player_a",
            "type": "pubkey"
          },
          {
            "name": "amount_refunded",
            "type": "u64"
          },
          {
            "name": "timestamp",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "MatchDeliveryState",
      "docs": [
        "Match-scoped delivery state PDA",
        "Seeds: [\"delivery\", match_id.to_le_bytes()]",
        "",
        "This PDA tracks which customers are currently available for delivery.",
        "Availability rotates every 60 seconds using deterministic on-chain randomness.",
        "",
        "Authority: Solana ONLY",
        "- Client renders indicators but cannot influence availability",
        "- sell_to_customer validates against this state"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "docs": [
              "Unique match identifier (must match corresponding MatchState)"
            ],
            "type": "u64"
          },
          {
            "name": "last_update_ts",
            "docs": [
              "Timestamp of last delivery slot refresh",
              "Used to enforce 60s minimum between refreshes"
            ],
            "type": "i64"
          },
          {
            "name": "available_customers",
            "docs": [
              "Currently available customer indices (0-22)",
              "Exactly MAX_DELIVERY_SPOTS slots; unused slots = 255 (invalid)"
            ],
            "type": {
              "array": [
                "u8",
                5
              ]
            }
          },
          {
            "name": "active_count",
            "docs": [
              "Count of valid entries in available_customers",
              "Guaranteed: 3 <= active_count <= MAX_DELIVERY_SPOTS"
            ],
            "type": "u8"
          },
          {
            "name": "bump",
            "docs": [
              "PDA bump seed"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "MatchFinalizedEvent",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "finalized_at",
            "type": "i64"
          },
          {
            "name": "player_a_sales",
            "type": "u32"
          },
          {
            "name": "player_b_sales",
            "type": "u32"
          },
          {
            "name": "player_a_reputation",
            "type": "i32"
          },
          {
            "name": "player_b_reputation",
            "type": "i32"
          }
        ]
      }
    },
    {
      "name": "MatchGrowState",
      "docs": [
        "Match-scoped grow state PDA",
        "Seeds: [\"grow\", match_id.to_le_bytes()]"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "docs": [
              "Unique match identifier (must match corresponding MatchState)"
            ],
            "type": "u64"
          },
          {
            "name": "match_id_hash",
            "docs": [
              "32-byte hash used for MatchState PDA derivation (canonical)"
            ],
            "type": {
              "array": [
                "u8",
                32
              ]
            }
          },
          {
            "name": "player_a",
            "docs": [
              "Player A wallet (must match MatchState.player_a)"
            ],
            "type": "pubkey"
          },
          {
            "name": "player_b",
            "docs": [
              "Player B wallet (must match MatchState.player_b)"
            ],
            "type": "pubkey"
          },
          {
            "name": "player_a_slots",
            "docs": [
              "Player A's 6 grow slots"
            ],
            "type": {
              "array": [
                {
                  "defined": {
                    "name": "GrowSlot"
                  }
                },
                6
              ]
            }
          },
          {
            "name": "player_b_slots",
            "docs": [
              "Player B's 6 grow slots"
            ],
            "type": {
              "array": [
                {
                  "defined": {
                    "name": "GrowSlot"
                  }
                },
                6
              ]
            }
          },
          {
            "name": "player_a_inventory",
            "docs": [
              "Player A's harvested inventory"
            ],
            "type": {
              "defined": {
                "name": "Inventory"
              }
            }
          },
          {
            "name": "player_b_inventory",
            "docs": [
              "Player B's harvested inventory"
            ],
            "type": {
              "defined": {
                "name": "Inventory"
              }
            }
          },
          {
            "name": "bump",
            "docs": [
              "PDA bump seed"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "MatchStakeInitializedEvent",
      "docs": [
        "Event emitted when Player A initializes match with stake"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "player_a",
            "type": "pubkey"
          },
          {
            "name": "player_b",
            "type": "pubkey"
          },
          {
            "name": "amount_escrowed",
            "type": "u64"
          },
          {
            "name": "timestamp",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "MatchStakeState",
      "docs": [
        "Match-scoped stake state PDA",
        "",
        "Seeds: [\"stake\", match_id_hash]",
        "",
        "This account tracks the staking lifecycle for a match.",
        "The actual token balance is always authoritative - cached values",
        "(player_a_escrowed, player_b_escrowed) are for accounting only.",
        "",
        "Authority Hierarchy Compliance:",
        "- This state is Solana-authoritative",
        "- Token transfers are program-controlled via escrow PDA",
        "- No client can modify this state directly"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "docs": [
              "Unique match identifier (derived from match_id_hash)"
            ],
            "type": "u64"
          },
          {
            "name": "match_id_hash",
            "docs": [
              "32-byte hash used for PDA derivation (matches MatchState)"
            ],
            "type": {
              "array": [
                "u8",
                32
              ]
            }
          },
          {
            "name": "player_a",
            "docs": [
              "Player A's wallet address"
            ],
            "type": "pubkey"
          },
          {
            "name": "player_b",
            "docs": [
              "Player B's wallet address"
            ],
            "type": "pubkey"
          },
          {
            "name": "status",
            "docs": [
              "Current status of the match staking lifecycle"
            ],
            "type": {
              "defined": {
                "name": "MatchStatus"
              }
            }
          },
          {
            "name": "player_a_escrowed",
            "docs": [
              "Amount Player A escrowed (pre-burn, for accounting)",
              "Note: Actual escrow balance is authoritative, this is informational"
            ],
            "type": "u64"
          },
          {
            "name": "player_b_escrowed",
            "docs": [
              "Amount Player B escrowed (pre-burn, for accounting)",
              "Note: Actual escrow balance is authoritative, this is informational"
            ],
            "type": "u64"
          },
          {
            "name": "created_at",
            "docs": [
              "Timestamp when Player A initialized the match (for cancel timeout)"
            ],
            "type": "i64"
          },
          {
            "name": "bump",
            "docs": [
              "PDA bump seed"
            ],
            "type": "u8"
          },
          {
            "name": "escrow_bump",
            "docs": [
              "Escrow token account bump (for PDA signing)"
            ],
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "MatchState",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "match_id_hash",
            "type": {
              "array": [
                "u8",
                32
              ]
            }
          },
          {
            "name": "start_ts",
            "type": "i64"
          },
          {
            "name": "end_ts",
            "type": "i64"
          },
          {
            "name": "player_a",
            "type": "pubkey"
          },
          {
            "name": "player_b",
            "type": "pubkey"
          },
          {
            "name": "customers",
            "type": {
              "array": [
                {
                  "defined": {
                    "name": "CustomerState"
                  }
                },
                23
              ]
            }
          },
          {
            "name": "player_a_sales",
            "type": "u32"
          },
          {
            "name": "player_b_sales",
            "type": "u32"
          },
          {
            "name": "player_a_reputation",
            "type": "i32"
          },
          {
            "name": "player_b_reputation",
            "type": "i32"
          },
          {
            "name": "is_finalized",
            "type": "bool"
          },
          {
            "name": "bump",
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "MatchStatus",
      "docs": [
        "Match status for staking lifecycle",
        "",
        "State transitions:",
        "- Pending -> Active (when Player B joins and burn occurs)",
        "- Pending -> Cancelled (when Player A cancels after timeout)",
        "- Active -> Finalized (when match ends and winner is paid)"
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "Pending"
          },
          {
            "name": "Active"
          },
          {
            "name": "Finalized"
          },
          {
            "name": "Cancelled"
          }
        ]
      }
    },
    {
      "name": "PlantState",
      "docs": [
        "Plant state enum - represents the lifecycle of a plant in a slot",
        "Slots = Land (persistent), Plants = Ephemeral (destroyed on harvest)"
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "Empty"
          },
          {
            "name": "Growing",
            "fields": [
              {
                "name": "strain_level",
                "docs": [
                  "Strain level (1, 2, or 3)"
                ],
                "type": "u8"
              },
              {
                "name": "planted_at",
                "docs": [
                  "Timestamp when plant was planted"
                ],
                "type": "i64"
              }
            ]
          },
          {
            "name": "Ready",
            "fields": [
              {
                "name": "strain_level",
                "docs": [
                  "Strain level (1, 2, or 3)"
                ],
                "type": "u8"
              }
            ]
          }
        ]
      }
    },
    {
      "name": "PlantStrainEvent",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "player",
            "type": "pubkey"
          },
          {
            "name": "slot_index",
            "type": "u8"
          },
          {
            "name": "strain_level",
            "type": "u8"
          },
          {
            "name": "variant_id",
            "type": "u8"
          },
          {
            "name": "planted_ts",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "SaleEvent",
      "docs": [
        "Enhanced sale event for auditability and analytics.",
        "All fields are included for post-match verification, replay, and indexing."
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "docs": [
              "Unique match identifier"
            ],
            "type": "u64"
          },
          {
            "name": "customer_index",
            "docs": [
              "Customer index (0-22) - the CANONICAL on-chain identity"
            ],
            "type": "u8"
          },
          {
            "name": "customer_layer",
            "docs": [
              "Customer layer (1-3) - DERIVED from customer_index for convenience"
            ],
            "type": "u8"
          },
          {
            "name": "strain_level",
            "docs": [
              "Strain level used for this sale (1-3)"
            ],
            "type": "u8"
          },
          {
            "name": "variant_id",
            "docs": [
              "Variant ID of the sold strain (0, 1, or 2)"
            ],
            "type": "u8"
          },
          {
            "name": "player",
            "docs": [
              "Player who made the sale"
            ],
            "type": "pubkey"
          },
          {
            "name": "base_reputation_delta",
            "docs": [
              "Base reputation change from this sale (before variant modifier)"
            ],
            "type": "i32"
          },
          {
            "name": "variant_bonus",
            "docs": [
              "Variant reputation bonus/penalty (-1, 0, or +1)"
            ],
            "type": "i32"
          },
          {
            "name": "total_reputation_delta",
            "docs": [
              "Total reputation change (base + variant)"
            ],
            "type": "i32"
          },
          {
            "name": "timestamp",
            "docs": [
              "On-chain timestamp when sale was recorded"
            ],
            "type": "i64"
          },
          {
            "name": "remaining_inventory",
            "docs": [
              "Remaining inventory of this strain level after sale"
            ],
            "type": "u8"
          },
          {
            "name": "rotation_bucket",
            "docs": [
              "Delivery rotation bucket (ts / 60) for replay verification",
              "Allows post-match audit to verify customer was legitimately available"
            ],
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "StakePayoutEvent",
      "docs": [
        "Event emitted when winner receives payout"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_id",
            "type": "u64"
          },
          {
            "name": "winner",
            "type": "pubkey"
          },
          {
            "name": "loser",
            "type": "pubkey"
          },
          {
            "name": "amount",
            "type": "u64"
          },
          {
            "name": "winner_sales",
            "type": "u32"
          },
          {
            "name": "loser_sales",
            "type": "u32"
          },
          {
            "name": "timestamp",
            "type": "i64"
          }
        ]
      }
    }
  ]
}